-- vim:syntax=lua:set ts=4 sw=4:
-- Config file example usable for privacy-preserving resolver
-- Refer to manual: https://knot-resolver.readthedocs.io/en/stable/startguide.html#personal-privacy-preserving-resolver
@config_defaults@

-- TLS server configuration
-- Use this to configure your TLS certificates
-- net.tls("/etc/knot-resolver/server-cert.pem", "/etc/knot-resolver/server-key.pem")

-- move cache to '/tmp/knot-resolver' tmpfs
cache.storage = 'lmdb:///tmp/knot-resolver'

-- forwarding to multiple targets
policy.add(policy.slice(
   policy.slice_randomize_psl(),
   -- forward over TLS
   policy.TLS_FORWARD({
      {'2001:DB8::d0c', hostname='res.example.com'},
      {'192.0.2.1', pin_sha256={'YQ=='}
   }),
   -- multiple servers can be specified for a single slice
   -- the one with lowest round-trip time will be used
   policy.TLS_FORWARD({
      {'193.17.47.1', hostname='odvr.nic.cz'},
      {'185.43.135.1', hostname='odvr.nic.cz'},
   })
))