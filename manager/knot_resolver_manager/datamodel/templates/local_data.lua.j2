{% from 'macros/local_data_macros.lua.j2' import local_data_rules, local_data_records, local_data_root_fallback_addresses, local_data_root_fallback_addresses_files, local_data_addresses, local_data_addresses_files %}
{% from 'macros/common_macros.lua.j2' import boolean, modules_load %}

--------------------------------------------------------------------------------
-- LOCAL-DATA configuration
--------------------------------------------------------------------------------

-- load 'hints' module
{{ modules_load('hints > iterate') }}

{% if cfg.local_data.root_fallback_addresses -%}
-- local-data.root-fallback-addresses
{{ local_data_root_fallback_addresses(cfg.local_data.root_fallback_addresses) }}
{%- endif %}

{% if cfg.local_data.root_fallback_addresses_files %}
-- local-data.root-fallback-addresses-files
{{ local_data_root_fallback_addresses_files(cfg.local_data.root_fallback_addresses_files) }}
{%- endif %}

{% if cfg.local_data.addresses %}
-- local-data.addresses
{{ local_data_addresses(cfg.local_data.addresses, cfg.local_data.nodata, cfg.local_data.ttl) }}
{% endif %}

{% if cfg.local_data.addresses_files %}
-- local-data.addresses-files
{{ local_data_addresses_files(cfg.local_data.addresses_files, cfg.local_data.nodata, cfg.local_data.ttl) }}
{% endif %}

{% if cfg.local_data.records %}
-- local-data.records
{{ local_data_records(cfg.local_data.records, false, cfg.local_data.nodata, cfg.local_data.ttl) }}
{% endif %}

{% if cfg.local_data.rules %}
-- local-data.rules
{{ local_data_rules(cfg.local_data.rules, cfg.local_data.nodata, cfg.local_data.ttl) }}
{% endif %}

{% if cfg.local_data.rpz %}
-- local-data.rpz
{% for rpz in cfg.local_data.rpz %}
{{ local_data_records(rpz.file, true, cfg.local_data.nodata, cfg.local_data.ttl, rpz.tags) }}
{% endfor %}
{% endif %}
